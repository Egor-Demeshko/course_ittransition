<script>
    import { deleteTagLink } from "$tags/deleteTagLink";

    /** @type {import('$types/types').TagsLink}*/
    export let tagLink;

    let {
        id: tagLinkId,
        tag: { id, value },
    } = tagLink;

    let block = false;

    async function deleteTag() {
        if (block) return;
        block = true;
        await deleteTagLink(tagLinkId);

        block = false;
    }
</script>

<div class="tag">
    <span>{value}</span>

    <div class="icon" on:click={deleteTag}>
        <svg
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <path
                d="M7.9976 16.0003C6.94694 16.0023 5.90624 15.7966 4.93533 15.3951C3.96442 14.9935 3.08242 14.4041 2.34003 13.6606C-0.780012 10.5406 -0.780012 5.46427 2.34003 2.34422C3.08132 1.59878 3.9631 1.00776 4.93433 0.605376C5.90556 0.202995 6.94696 -0.0027577 7.99824 2.79109e-05C10.1357 2.79109e-05 12.1451 0.832211 13.6558 2.34422C15.1672 3.8556 16 5.865 16 8.00243C16 10.1399 15.1678 12.1493 13.6558 13.6606C12.9133 14.4041 12.0312 14.9935 11.0602 15.395C10.0891 15.7966 9.04836 16.0023 7.9976 16.0003ZM7.99824 1.28031C7.11512 1.2778 6.24028 1.45055 5.4244 1.78855C4.60852 2.12655 3.86781 2.62308 3.24519 3.24938C1.97579 4.51878 1.27676 6.20683 1.27676 8.00243C1.27676 9.79802 1.97579 11.4854 3.24519 12.7555C5.86593 15.3762 10.1305 15.3768 12.7506 12.7555C14.02 11.4861 14.7197 9.79802 14.7197 8.00243C14.7197 6.20683 14.0207 4.51942 12.7506 3.24938C12.128 2.62328 11.3874 2.12686 10.5717 1.78887C9.75591 1.45088 8.88123 1.27803 7.99824 1.28031Z"
                fill="currentColor"
            />
            <path
                d="M7.9976 16.0003C6.94694 16.0023 5.90624 15.7966 4.93533 15.3951C3.96442 14.9935 3.08242 14.4041 2.34003 13.6606C-0.780012 10.5406 -0.780012 5.46427 2.34003 2.34422C3.08132 1.59878 3.9631 1.00776 4.93433 0.605376C5.90556 0.202995 6.94696 -0.0027577 7.99824 2.79109e-05C10.1357 2.79109e-05 12.1451 0.832211 13.6558 2.34422C15.1672 3.8556 16 5.865 16 8.00243C16 10.1399 15.1678 12.1493 13.6558 13.6606C12.9133 14.4041 12.0312 14.9935 11.0602 15.395C10.0891 15.7966 9.04836 16.0023 7.9976 16.0003ZM7.99824 1.28031C7.11512 1.2778 6.24028 1.45055 5.4244 1.78855C4.60852 2.12655 3.86781 2.62308 3.24519 3.24938C1.97579 4.51878 1.27676 6.20683 1.27676 8.00243C1.27676 9.79802 1.97579 11.4854 3.24519 12.7555C5.86593 15.3762 10.1305 15.3768 12.7506 12.7555C14.02 11.4861 14.7197 9.79802 14.7197 8.00243C14.7197 6.20683 14.0207 4.51942 12.7506 3.24938C12.128 2.62328 11.3874 2.12686 10.5717 1.78887C9.75591 1.45088 8.88123 1.27803 7.99824 1.28031Z"
                fill="currentColor"
            />
            <path
                d="M5.28215 11.358C5.15542 11.3583 5.03147 11.3209 4.92603 11.2506C4.82058 11.1803 4.7384 11.0803 4.68991 10.9632C4.64142 10.8461 4.6288 10.7173 4.65367 10.593C4.67853 10.4688 4.73976 10.3547 4.82957 10.2653L10.2612 4.83371C10.3206 4.77427 10.3912 4.72713 10.4688 4.69496C10.5465 4.6628 10.6297 4.64624 10.7137 4.64624C10.7978 4.64624 10.881 4.6628 10.9587 4.69496C11.0363 4.72713 11.1069 4.77427 11.1663 4.83371C11.2258 4.89314 11.2729 4.9637 11.3051 5.04135C11.3372 5.119 11.3538 5.20223 11.3538 5.28628C11.3538 5.37034 11.3372 5.45357 11.3051 5.53122C11.2729 5.60887 11.2258 5.67943 11.1663 5.73886L5.73473 11.1705C5.67545 11.2301 5.60492 11.2774 5.52723 11.3096C5.44955 11.3418 5.36624 11.3582 5.28215 11.358Z"
                fill="currentColor"
            />
            <path
                d="M10.7137 11.358C10.6297 11.3581 10.5464 11.3416 10.4687 11.3094C10.3911 11.2772 10.3205 11.23 10.2611 11.1705L4.82955 5.73886C4.77012 5.67943 4.72298 5.60887 4.69081 5.53122C4.65865 5.45357 4.64209 5.37034 4.64209 5.28628C4.64209 5.20223 4.65865 5.119 4.69081 5.04135C4.72298 4.9637 4.77012 4.89314 4.82955 4.83371C4.88899 4.77427 4.95955 4.72713 5.0372 4.69496C5.11485 4.6628 5.19808 4.64624 5.28213 4.64624C5.36619 4.64624 5.44941 4.6628 5.52707 4.69496C5.60472 4.72713 5.67528 4.77427 5.73471 4.83371L11.1663 10.2653C11.2561 10.3547 11.3173 10.4688 11.3422 10.593C11.3671 10.7173 11.3545 10.8461 11.306 10.9632C11.2575 11.0803 11.1753 11.1803 11.0699 11.2506C10.9644 11.3209 10.8405 11.3583 10.7137 11.358Z"
                fill="currentColor"
            />
        </svg>
    </div>
</div>

<style>
    .tag {
        position: relative;
        padding: 0.625rem 1.125rem;
        background-color: var(--light-violet);
        color: var(--dark-violet);
        font-family: Poppins, sans-serif;
        border-radius: 10px;
        font-weight: bold;
        font-size: 0.875rem;
        cursor: pointer;
    }

    .icon {
        display: flex;
        background-color: var(--dark-transparent);
        opacity: 0;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 10px;
        justify-content: center;
        align-items: center;
        transition: opacity 0.4s ease;
    }

    .tag:hover > .icon {
        opacity: 1;
    }

    svg {
        color: var(--red);
    }
</style>
